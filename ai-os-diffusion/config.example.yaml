# AI-OS Unified Diffusion Architecture Configuration

# Model Configuration
model:
  # Model type: "unified_diffusion"
  type: "unified_diffusion"
  
  # Model path (Parquet V2 format with ArrowQuant)
  path: "models/diffusion-base"
  
  # Quantization settings
  quantization:
    enabled: true
    method: "arrowquant_v1"
    bit_width: 2  # INT2 for edge deployment
  
  # Diffusion settings
  diffusion:
    num_inference_steps: 4  # Consistency distilled
    guidance_scale: 3.0
    scheduler_type: "cosine"  # cosine, linear, custom

# Rust Skeleton Configuration (Infrastructure)
rust:
  # ArrowStorage settings
  arrow_storage:
    path: "storage/memory.arrow"
    vector_dim: 768
    index_type: "flat"  # flat, ivf, hnsw
  
  # ArrowQuant settings
  arrow_quant:
    cache_size_mb: 512
    num_threads: 4
  
  # FastTokenizer settings
  fast_tokenizer:
    model_name: "bert-base-uncased"
    max_length: 512
    batch_size: 32

# Python Brain Configuration (Learning Layer)
brain:
  # DiffusionCore settings
  diffusion_core:
    hidden_dim: 768
    num_layers: 12
    num_heads: 12
    intermediate_dim: 3072
  
  # MemoryConditioner settings
  memory_conditioner:
    enabled: true
    top_k: 5
    condition_dim: 768
    relevance_threshold: 0.7
  
  # UncertaintyEstimator settings
  uncertainty_estimator:
    enabled: true
    threshold: 1.5
    window_size: 10
  
  # EvolutionRouter settings
  evolution_router:
    # L0: Score composition (zero-training)
    l0_enabled: true
    l0_weights: [0.7, 0.3]  # [base, control]
    
    # L1: ControlNet (structural constraints)
    l1_enabled: false
    l1_controlnet_path: "models/controlnets"
    
    # L2: LoRA (domain adaptation)
    l2_enabled: false
    l2_lora_path: "models/lora_cards"
    l2_rank: 8
    
    # L3: Selective fine-tuning
    l3_enabled: false
    l3_learning_rate: 1e-5
    
    # L4: Full fine-tuning
    l4_enabled: false
    l4_learning_rate: 1e-6

# Modality Configuration
modalities:
  text:
    enabled: true
    projection_head_path: "models/diffusion-base/heads/text_head.parquet"
    max_length: 512
  
  code:
    enabled: true
    projection_head_path: "models/diffusion-base/heads/code_head.parquet"
    max_length: 1024
  
  image:
    enabled: false  # Enable in Phase 3
    projection_head_path: "models/diffusion-base/heads/image_head.parquet"
    resolution: [512, 512]
    vae_path: "models/diffusion-base/vae"
  
  audio:
    enabled: false  # Enable in Phase 3
    projection_head_path: "models/diffusion-base/heads/audio_head.parquet"
    sample_rate: 16000
    duration_sec: 10

# Deployment Configuration
deployment:
  # Tier: edge, local, cloud
  tier: "local"
  
  # Device: cpu, cuda, mps
  device: "cpu"
  
  # Memory limits
  max_memory_mb: 4096
  
  # Performance settings
  num_threads: 4
  enable_amp: false  # Automatic Mixed Precision

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/ai_os_diffusion.log"
  console: true

# Monitoring Configuration
monitoring:
  enabled: false
  metrics_port: 9090
  tensorboard_dir: "runs"

# Development Configuration
development:
  debug: false
  profile: false
  save_intermediate: false
  checkpoint_dir: "checkpoints"
